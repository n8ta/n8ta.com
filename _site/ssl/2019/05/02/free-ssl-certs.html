<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-111016820-3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-111016820-3');
    </script>
    <link rel="stylesheet" href="/assets/css/styles.css"/>

    <link rel="stylesheet" href="/assets/css/atom-one-dark.css">
    <script src="/assets/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>
<div id="header-and-page">
    <a id='homepage-link' href="/"><h1>Nate Tracy-Amoroso</h1></a>
    <div>
        <a href="/">Home</a> > Free SSL Certificates with Let's Encrypt

<article class="post">
<p>SSL certificates can cost anywhere from $12-$100s of dollars a year, and since you can now get them for free I don’t see a great reason to buy them.</p>

<p>In this guide I’m going to be assuming that you have your own web server setup that you can figure to look in an arbitrary directory for SSL certs / keys. I’m also going to be assuming you’ve purchased a domain name and added an A record (or similar) pointing at your ip.</p>

<p>We’re going to setup automatically renewing SSL certificates with Lego a cli get certs, and cron to automatically run lego.</p>

<p>I’m going to be doing this on a basic aws linux instance running Amazon Linux V2, which uses the yum package manager. Things should be fairly similar running Ubuntu/Debian.</p>
<h3 id="step-1---install-the-lego-binary">Step 1 - Install the lego binary</h3>
<p>Pick your os and architecture and copy the link from this page: <a href="https://github.com/go-acme/lego/releases">https://github.com/go-acme/lego/releases</a> Then download it, untar it, and move it to your directory of binaries.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">wget FILL_THIS_IN.tar.gz
<span class="nb">tar</span> <span class="nt">-xvf</span> lego_vX.Y.Z_OS_###.tar.gz
<span class="nb">sudo mv </span>lego /usr/bin</code></pre></figure>

<h3 id="step-2---setup-folders-and-renewal-script">Step 2 - Setup folders and renewal script</h3>
<p>Next head to wherever you want your certs installed, for me that’ll be /etc/certs.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo</span> <span class="nt">-s</span>
<span class="nb">mkdir</span> /etc/certs
<span class="nb">cd</span> /etc/certs/
<span class="nb">touch </span>renew.sh
<span class="nb">echo</span> <span class="s2">"service apache2 stop; lego --email='your-email@servicecom' --domains='www.your_domain.com' --domains='your_domain.com' --path='/etc/certs' renew; service apache2 start;"</span> <span class="o">&gt;&gt;</span> renew.sh</code></pre></figure>

<p>You’ll need to fill in your email and domain. You can add as many –domains=’something.com’ as you like. I just did the www subdomain and root. You’ll also need to change the call to service to whatever service manager you use to turn your webserver off and on (lego temporarily uses port 80 to get certificates so you need to free the port).</p>
<h3 id="step-3---make-the-script-executable-and-run-it-from-cron">Step 3 - Make the script executable and run it from cron</h3>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">chmod</span> +x renew.sh
crontab <span class="nt">-e</span></code></pre></figure>

<p>crontab will open up an interactive window, in there add :</p>

<figure class="highlight"><pre><code class="language-crons" data-lang="crons">0 0 1 * * /etc/certs/renew.sh 2&gt; /dev/null</code></pre></figure>

<p>This will run the /etc/certs/renew.sh script once a month so they will not expire.</p>

<p>Finally run the same command once with run instead of renew at the end (manually)  and you’re all set</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">sudo </span>lego <span class="nt">--email</span><span class="o">=</span><span class="s1">'your-email@servicecom'</span> <span class="nt">--domains</span><span class="o">=</span><span class="s1">'www.your_domain.com'</span> <span class="nt">--domains</span><span class="o">=</span><span class="s1">'your_domain.com'</span> <span class="nt">--path</span><span class="o">=</span><span class="s1">'/etc/certs&lt;strong&gt;run&lt;/strong&gt;</span></code></pre></figure>

<p>And you’re all set. You should see two new folders:
accounts and certificates in /etc/certs.~~~~</p>

</article>

    </div>
</div>

</body>
</html>
